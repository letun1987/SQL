# SQL
Итоговый проект по SQL
Итоговый проект по модулю «SQL и получение данных»

Поздравляем! Вы дошли до финального проекта на курсе SQL. Осталось совсем немного: закрепить навыки и знания, которые вы получили, при решении комплекса задач.

Этапы подготовки
					
Ознакомьтесь с описанием базы данных. https://edu.postgrespro.ru/bookings.pdf
Подключитесь к базе данных avia по одному из следующих вариантов:
осуществите облачное подключение, используя те же настройки, что и у базы данных dvd-rental, только название базы total, схема bookings
импортируйте sql-запрос из sql-файла со второй страницы описания базы данных
восстановите базу из backup-файла по ссылке avia
Напишите запросы в соответствии с заданиями в таблице, представленной ниже. 
Отправьте работу на проверку.

Формат работы

Приложите решение в формате *.sql одним файлом. 
Отформатируйте запросы и в читаемом виде.

Важно: решения в других форматах – zip, jpg, pdf, doc, xls и так далее, – будут отправлены на доработку.

Описание задания

Напишите запросы в соответствии с заданиями в таблице, представленной ниже. 

№
Задание
Баллы
1
Выведите названия самолётов, которые имеют менее 50 посадочных мест.
10
2
Выведите процентное изменение ежемесячной суммы бронирования билетов, округленной до сотых.
25
3
Выведите названия самолётов без бизнес-класса. Используйте в решении функцию array_agg.
15
4
Выведите накопительный итог количества мест в самолётах по каждому аэропорту на каждый день. Учтите только те самолеты, которые летали пустыми и только те дни, когда из одного аэропорта вылетело более одного такого самолёта.

Выведите в результат код аэропорта, дату вылета, количество пустых мест и накопительный итог.
35
5
Найдите процентное соотношение перелётов по маршрутам от общего количества перелётов. Выведите в результат названия аэропортов и процентное отношение.

Используйте в решении оконную функцию.
20
6
Выведите количество пассажиров по каждому коду сотового оператора. Код оператора – это три символа после +7
15
7
Классифицируйте финансовые обороты (сумму стоимости билетов) по маршрутам:
до 50 млн – low
от 50 млн включительно до 150 млн – middle
от 150 млн включительно – high
Выведите в результат количество маршрутов в каждом полученном классе.
20
8*
Вычислите медиану стоимости билетов, медиану стоимости бронирования и отношение медианы бронирования к медиане стоимости билетов, результат округлите до сотых. 
25
9*
Найдите значение минимальной стоимости одного километра полёта для пассажира. Для этого определите расстояние между аэропортами и учтите стоимость билетов.

Для поиска расстояния между двумя точками на поверхности Земли используйте дополнительный модуль earthdistance. Для работы данного модуля нужно установить ещё один модуль – cube.

Важно: 
Установка дополнительных модулей происходит через оператор CREATE EXTENSION название_модуля.
В облачной базе данных модули уже установлены.
Функция earth_distance возвращает результат в метрах.
35



Примечания:	
Рейс, перелёт – это flight_id, разовый перелет между двумя аэропортами
Маршрут – это все перелёты между двумя аэропортами.
Знак *  указан рядом с заданиями на самостоятельную работу с документацией PostgreSQL.

Критерии оценки

За каждое правильно выполненное задание вы получите баллы, указанные в последнем столбце. Максимум за работу можно набрать 200 баллов. 

Для получения зачёта вам необходимо набрать минимум 130 баллов.

За что могут быть снижены баллы в каждом задании:

Критерий
Вес в баллах
Решение выполнено не в соответствии с условием задания: 
часть условий не выполнена
введены дополнительные условия, 
которых не было в задании
минус 5 или 10 баллов 

в зависимости от того, насколько 
серьёзные последствия для заказчика повлечёт ошибка
Указанные в задании функции не использованы или не влияют на полученный результат
минус 10 баллов
Ошибка в логике формирования запроса, 
в использовании операторов или функций
минус 10 баллов
Некорректная обработка данных
минус 10 баллов
Допущены ошибки в математических вычислениях
минус 10 баллов
Отработка запроса длится более 2 минут
за решение ставится 0 баллов
Использовано чужое решение
за решение ставится 0 баллов



Преподаватель вправе поставить незачёт без права пересдачи текущего задания, если студент прислал на проверку результат чужой работы.


Успехов в подготовке итогового проекта!
